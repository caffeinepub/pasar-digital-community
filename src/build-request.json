{
  "kind": "build_request",
  "title": "Fix PWA install prompt and home-screen icon on mobile (Android/iOS)",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Fix PWA asset addressing so the manifest, service worker, and all icon URLs work correctly when the app is served from any base path (not only domain root), ensuring the installed app launches in standalone mode and the app icon appears on the home screen.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "user-1"
        ],
        "quotes": [
          "ok. Kita sekarang  fokus ke Web App (PWA) nya, karena saya buka di handphone masih bentuk nya browser setelah tampilkan di layar utama, belum muncul teks Install dan juga logo nya juga tidak muncul,  untuk tampilan di layar handphone."
        ]
      },
      "acceptanceCriteria": [
        "Update `frontend/index.html` to reference the manifest and PWA icon assets using base-path-safe URLs (e.g., relative URLs) rather than hard-coded absolute `/...` paths.",
        "Update `frontend/public/manifest.webmanifest` to use base-path-safe `start_url` and `scope` values (e.g., relative `./`) and ensure all `icons[].src` values are base-path-safe.",
        "Update `frontend/src/pwa/registerServiceWorker.ts` to register the service worker with a base-path-safe URL (avoid hard-coded `'/sw.js'`).",
        "Verify the installed app (launched from home screen) opens without browser UI (standalone) on Android Chrome/Edge when installable criteria are met.",
        "Verify the home-screen icon is displayed correctly after installation on Android and iOS (using the existing generated icons in `/assets/generated/*`)."
      ]
    },
    {
      "id": "REQ-2",
      "text": "Add an in-app install entry point that displays an “Install” call-to-action on supported mobile browsers when the `beforeinstallprompt` event is available, without impacting existing app flows.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "user-1"
        ],
        "quotes": [
          "belum muncul teks Install"
        ]
      },
      "acceptanceCriteria": [
        "When `beforeinstallprompt` fires, show a small non-blocking UI element (e.g., banner/button) labeled \"Install\" / \"Install app\" that the user can tap to trigger the prompt.",
        "The install UI does not appear on browsers that do not support `beforeinstallprompt` (e.g., iOS Safari).",
        "The install UI can be dismissed and does not block navigation/authentication or any existing features.",
        "No backend changes are required for this feature."
      ]
    },
    {
      "id": "REQ-3",
      "text": "Ensure PWA-related static assets (manifest and icons) are served reliably and are not broken by service worker caching behavior, so updated icons/manifest are picked up correctly on mobile.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "user-1"
        ],
        "quotes": [
          "logo nya juga tidak muncul"
        ]
      },
      "acceptanceCriteria": [
        "`frontend/public/sw.js` must not return a synthetic 404 response for manifest/icon fetch failures; if the network is unavailable, it should fall back to cache (if available) or allow the request to fail normally without masking the error as a 404.",
        "Service worker caching rules must continue to avoid stale PWA metadata (manifest/icons) while not breaking normal asset loading.",
        "After a hard reload and reinstall attempt on mobile, the manifest and icon URLs resolve with HTTP 200 and correct content types from the static frontend."
      ]
    }
  ],
  "constraints": [
    "Do not modify backend canister logic or data structures; this request is PWA-only.",
    "Do not change existing routes, authentication behavior, or currently working features; PWA fixes must be isolated to PWA/asset/metadata/UI entry points.",
    "Do not edit files under `frontend/src/components/ui` or any other immutable paths listed in SYSTEM_CONTEXT."
  ],
  "nonGoals": [
    "Guaranteeing that every mobile browser will display a native install prompt (some platforms, especially iOS Safari, do not provide an automatic prompt).",
    "Adding push notifications or background sync.",
    "Changing app branding beyond fixing the existing icon/logo visibility and install metadata behavior."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  },
  "userProfileUpdate": {
    "goalsToAdd": [],
    "goalsToRemove": [],
    "preferencesToAdd": [],
    "preferencesToRemove": [],
    "miscToAdd": [],
    "miscToRemove": [],
    "fieldsToSet": {},
    "fieldsToDelete": []
  }
}